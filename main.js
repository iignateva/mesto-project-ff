!function(){"use strict";var e="card__delete-button_is-hided",t=function(e,t){e.textContent=t.likes.length>0?t.likes.length:""},n="popup_is-opened";function r(){var e=document.querySelector(".popup_is-opened");e&&a(e)}var o=function(e){"Escape"===e.key&&r()},c=function(e){e.target.classList.contains("popup")&&r()},a=function(e){e.classList.remove(n),document.removeEventListener("keyup",o),e.removeEventListener("click",c),u(e,!1)},i=function(){r()},u=function(e,t){var n=e.querySelector(".popup__close");n&&(t?n.addEventListener("click",i):n.removeEventListener("click",i))};function l(e,t,r){e.addEventListener("click",(function(a){!function(e){e.classList.add(n),document.addEventListener("keyup",o),e.addEventListener("click",c),u(e,!0)}(t),r&&r(t,e)}))}var s=function(e,t,n,r){e.classList.remove(t),n.textContent="",n.classList.remove(r)},p=function(e,t){e.disabled=!0,e.classList.add(t)},d=function(e,t){e.disabled=!1,e.classList.remove(t)},f="https://nomoreparties.co/v1/".concat("wff-cohort-26"),v={authorization:"795c02ad-0380-472a-86a4-d4f6a3b46af0","Content-Type":"application/json"},_=function(e,t,n){return fetch("".concat(f,"/").concat(e),{method:t,headers:v,body:n}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))};function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var m=".popup__input",S=".popup__button",h="popup__input_type_error",q="popup__error_visible",b="popup__button_disabled",E="card__like-button_is-active",L=document.querySelector("#card-template").content,g=document.querySelector(".places .places__list"),k=document.querySelector(".popup_type_edit"),C=document.forms["edit-profile"],w=C.querySelector(".popup__input_type_name"),A=C.querySelector(".popup__input_type_description"),x=document.querySelector(".profile__edit-button"),T=document.querySelector(".profile__title"),P=document.querySelector(".profile__description"),G=document.querySelector(".popup_type_new-card"),I=document.forms["new-place"],j=I.querySelector(".popup__input_type_card-name"),M=I.querySelector(".popup__input_type_url"),O=document.querySelector(".popup_type_image"),D=document.querySelector(".profile__add-button"),N=document.querySelector(".profile__image"),J=document.querySelector(".popup_type_action-accept"),V=document.querySelector(".popup_type_update-avatar"),B=document.forms["new-avatar"],H=V.querySelector(".popup__input_type_url"),U=function(n,r){g.append(function(n,r){return function(n,r,o,c,a,i,u,l,s,p){var d=n.querySelector(".card").cloneNode(!0);d.querySelector(".card__description .card__title").textContent=o.name,d.id="id_".concat(o._id);var f=d.querySelector(".card__like-button");f.addEventListener("click",(function(){return i(f,v,o._id)}));var v=d.querySelector(".card__likes-count");t(v,o);var _=d.querySelector(".card .card__delete-button");return o.owner._id===c._id?(_.cardId=o._id,u(_,a,p),_.classList.remove(e)):_.classList.add(e),u(l(d,o.link,o.name,".card__image"),r,s),d}(L,O,n,r,J,oe,l,ne,re,te)}(n,r))},z=function(e){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.buttonElementSelector);n.forEach((function(n){var r=e.querySelector(".".concat(n.id,"-error"));s(n,t.inputErrorClass,r,t.errorVisibleClass)})),p(r,t.inactiveButtonClass)}(e,{inputSelector:m,inputErrorClass:h,errorVisibleClass:q,buttonElementSelector:S,inactiveButtonClass:b})};C.addEventListener("submit",(function(e){e.preventDefault();var t={name:w.value,about:A.value};F(k,(function(e){var n;(n=t,_("/users/me","PATCH",JSON.stringify(n))).then((function(e){$(e),C.reset(),a(k)})).catch((function(e){console.error("Got an error while load profile ".concat(e))})).finally(e())}))})),B.addEventListener("submit",(function(e){e.preventDefault();var t={avatar:H.value};F(V,(function(e){(function(e){if(e&&e.avatar)return _("/users/me/avatar","PATCH",JSON.stringify(e))})(t).then((function(e){$(e),B.reset(),a(V)})).catch((function(e){console.error("Got an error while update avatar: ".concat(e))})).finally(e())}))}));var $=function(e){T.textContent=e.name,P.textContent=e.about,N.style.backgroundImage="url(".concat(e.avatar,")")};l(N,V),l(x,k,(function(){z(C),C&&(C.elements.name.value=T.textContent,C.elements.description.value=P.textContent)}));var F=function(e,t){var n=e.querySelector(S),r=n.textContent;n.textContent=r+"...",t((function(){n.textContent=r}))};I.addEventListener("submit",(function(e){e.preventDefault();var t={name:j.value,link:M.value};F(G,(function(e){var n;(n=t,_("/cards","POST",JSON.stringify(n))).then((function(e){I.reset(),a(G),U(e,e.owner)})).catch((function(e){console.error("Got an error while post new card: ".concat(e))})).finally(e())}))})),l(D,G,(function(){I.reset(),z(I)}));var K,Q,R,W,X,Y,Z=function(e){var t=e.target,n=t.cardId;n&&function(e){if(e)return _("/cards/".concat(e),"DELETE")}(n).then((function(){ee(n),t.removeEventListener("click",Z);var e=t.acceptPopup;a(e)})).catch((function(e){console.error("Got error: ".concat(e))}))},ee=function(e){var t=document.querySelector("#id_".concat(e));t&&t.remove()},te=function(e,t){var n=t.cardId,r=e.querySelector(S);r.cardId=n,r.acceptPopup=e,r.addEventListener("click",Z)},ne=function(e,t,n,r){var o=e.querySelector(r);return o.src=t,o.alt=n,o},re=function(e,t){ne(e,t.src,t.alt,".popup__image"),e.querySelector(".popup__caption").textContent=t.alt,e.classList.add("popup__image_viewing")},oe=function(e,n,r){var o;o=e.classList.contains(E)?function(e){if(e)return _("/cards/likes/".concat(e),"DELETE")}(r):function(e){if(e)return _("/cards/likes/".concat(e),"PUT")}(r),o.then((function(r){t(n,r),e.classList.toggle(E)})).catch((function(e){console.error("Got an error: ".concat(e))}))};K=m,Q=S,R=b,W=h,X=q,Array.from(document.querySelectorAll(".popup__form")).forEach((function(e){var t=e.querySelector(Q),n=Array.from(e.querySelectorAll(K));n.forEach((function(r){r.addEventListener("input",(function(){(function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));if(t.validity.valid)s(t,n,o,r);else{var c=t.validationMessage;switch(!0){case t.validity.patternMismatch:c=t.dataset.errorPatternMismatchMessage;break;case t.validity.valueMissing:c=t.dataset.errorEmptyValueMessage}!function(e,t,n,r,o){e.classList.add(t),n.textContent=r,n.classList.add(o)}(t,n,o,c,r)}})(e,r,W,X),function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?d(t,n):p(t,n)}(n,t,R)}))}))})),Y=[_("/users/me","GET"),_("/cards","GET")],Promise.all(Y).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],c=r[1];$(o),function(e,t){e.forEach((function(e){U(e,t)}))}(c,o)})).catch((function(e){console.error("Got an error while load page: ".concat(e))}))}();